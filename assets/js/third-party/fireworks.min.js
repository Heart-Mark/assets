var ctx,numberOfParticules,pointerX,pointerY,tap,colors,setCanvasSize,render,canvasEl=document.querySelector(".fireworks");function updateCoords(e){pointerX=(e.clientX||e.touches[0].clientX)-canvasEl.getBoundingClientRect().left,pointerY=e.clientY||e.touches[0].clientY-canvasEl.getBoundingClientRect().top}function setParticuleDirection(e){var t=bangumi.random(0,360)*Math.PI/180,a=bangumi.random(50,180),a=[-1,1][bangumi.random(0,1)]*a;return{x:e.x+a*Math.cos(t),y:e.y+a*Math.sin(t)}}function createParticule(e,t){var a={};return a.x=e,a.y=t,a.color=colors[bangumi.random(0,colors.length-1)],a.radius=bangumi.random(16,32),a.endPos=setParticuleDirection(a),a.draw=function(){ctx.beginPath(),ctx.arc(a.x,a.y,a.radius,0,2*Math.PI,!0),ctx.fillStyle=a.color,ctx.fill()},a}function createCircle(e,t){var a={};return a.x=e,a.y=t,a.color="#F00",a.radius=.1,a.alpha=.5,a.lineWidth=6,a.draw=function(){ctx.globalAlpha=a.alpha,ctx.beginPath(),ctx.arc(a.x,a.y,a.radius,0,2*Math.PI,!0),ctx.lineWidth=a.lineWidth,ctx.strokeStyle=a.color,ctx.stroke(),ctx.globalAlpha=1},a}function renderParticule(e){for(var t=0;t<e.animatables.length;t++)e.animatables[t].target.draw()}function animateParticules(e,t){for(var a=createCircle(e,t),n=[],i=0;i<numberOfParticules;i++)n.push(createParticule(e,t));bangumi.timeline().add({targets:n,x:function(e){return e.endPos.x},y:function(e){return e.endPos.y},radius:.1,duration:bangumi.random(1200,1800),easing:"easeOutExpo",update:renderParticule}).add({targets:a,radius:bangumi.random(80,160),lineWidth:0,alpha:{value:0,easing:"linear",duration:bangumi.random(600,800)},duration:bangumi.random(1200,1800),easing:"easeOutExpo",update:renderParticule,offset:0})}canvasEl&&(ctx=canvasEl.getContext("2d"),numberOfParticules=30,pointerY=pointerX=0,tap="mousedown",colors=["#FF1461","#18FF92","#5A87FF","#FBF38C"],setCanvasSize=debounce(function(){canvasEl.width=window.innerWidth,canvasEl.height=window.innerHeight,canvasEl.style.width=window.innerWidth+"px",canvasEl.style.height=window.innerHeight+"px",canvasEl.getContext("2d").scale(1,1)},500),render=bangumi({duration:1/0,update:function(){ctx.clearRect(0,0,canvasEl.width,canvasEl.height)}}),document.addEventListener(tap,function(e){"sidebar"!==e.target.id&&"toggle-sidebar"!==e.target.id&&"A"!==e.target.nodeName&&"IMG"!==e.target.nodeName&&(render.play(),updateCoords(e),animateParticules(pointerX,pointerY))},!1),setCanvasSize(),window.addEventListener("resize",setCanvasSize,!1));